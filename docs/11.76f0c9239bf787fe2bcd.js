(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"NT/C":function(n,t,i){"use strict";i.r(t),i.d(t,"FilterPageModule",(function(){return T}));var o=i("Yvf7"),c=i("8VHZ"),e=i("P4DM"),b=i("Fk62"),s=i("Ub9n"),l=i("XpMW");let r=(()=>{class n{constructor(n){this.store=n,this.collection="Tags"}list(){return this.store.collection(this.collection,n=>n.orderBy("text","asc")).snapshotChanges()}}return n.\u0275fac=function(t){return new(t||n)(s.Rb(l.a))},n.\u0275prov=s.Eb({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var u=i("UcdY");function a(n,t){1&n&&s.Jb(0,"ion-icon",11)}function g(n,t){1&n&&s.Jb(0,"ion-icon",11)}function f(n,t){1&n&&s.Jb(0,"ion-icon",11)}function p(n,t){if(1&n){const n=s.Ob();s.Lb(0),s.Nb(1,"ion-chip",9),s.Vb("click",(function(){s.gc(n);const i=t.$implicit;return s.Xb(6).onBtnAddTopicClicked(i.text)})),s.kc(2,f,1,0,"ion-icon",10),s.Nb(3,"ion-label"),s.lc(4),s.Mb(),s.Mb(),s.Kb()}if(2&n){const n=t.$implicit,i=s.Xb(6);s.yb(2),s.cc("ngIf",i.topics.indexOf(n.text)>-1),s.yb(2),s.mc(n.text)}}function h(n,t){if(1&n&&(s.Lb(0),s.kc(1,p,5,2,"ng-container",3),s.Kb()),2&n){const n=s.Xb().$implicit;s.yb(1),s.cc("ngForOf",n.tags)}}function d(n,t){if(1&n){const n=s.Ob();s.Lb(0),s.Nb(1,"ion-chip",9),s.Vb("click",(function(){s.gc(n);const i=t.$implicit;return s.Xb(4).onBtnAddTopicClicked(i.text)})),s.kc(2,g,1,0,"ion-icon",10),s.Nb(3,"ion-label"),s.lc(4),s.Mb(),s.Mb(),s.kc(5,h,2,1,"ng-container",0),s.Kb()}if(2&n){const n=t.$implicit,i=s.Xb(4);s.yb(2),s.cc("ngIf",i.topics.indexOf(n.text)>-1),s.yb(2),s.mc(n.text),s.yb(1),s.cc("ngIf",n.tags)}}function M(n,t){if(1&n&&(s.Lb(0),s.kc(1,d,6,3,"ng-container",3),s.Kb()),2&n){const n=s.Xb().$implicit;s.yb(1),s.cc("ngForOf",n.tags)}}function m(n,t){if(1&n){const n=s.Ob();s.Lb(0),s.Nb(1,"ion-chip",9),s.Vb("click",(function(){s.gc(n);const i=t.$implicit;return s.Xb(2).onBtnAddTopicClicked(i.text)})),s.kc(2,a,1,0,"ion-icon",10),s.Nb(3,"ion-label"),s.lc(4),s.Mb(),s.Mb(),s.kc(5,M,2,1,"ng-container",0),s.Kb()}if(2&n){const n=t.$implicit,i=s.Xb(2);s.yb(2),s.cc("ngIf",i.topics.indexOf(n.text)>-1),s.yb(2),s.mc(n.text),s.yb(1),s.cc("ngIf",n.tags)}}function y(n,t){if(1&n){const n=s.Ob();s.Nb(0,"ion-button",9),s.Vb("click",(function(){return s.gc(n),s.Xb(2).onBtnQueryClicked()})),s.lc(1," \u958b\u59cb\u67e5\u8a62 "),s.Mb()}}function N(n,t){if(1&n){const n=s.Ob();s.Lb(0),s.Nb(1,"div"),s.Nb(2,"div",1),s.Nb(3,"h3"),s.lc(4,"\u8a2d\u5b9a\u7be9\u9078\u689d\u4ef6"),s.Mb(),s.Nb(5,"small"),s.lc(6,"\u8a2d\u5b9a\u5b8c\u7562\u5f8c\u8acb\u9ede\u64ca\u958b\u59cb\u67e5\u8a62\u6309\u9215"),s.Mb(),s.Mb(),s.Nb(7,"ion-list"),s.Nb(8,"ion-list-header"),s.Nb(9,"ion-label"),s.lc(10,"\u4e3b\u984c"),s.Mb(),s.Mb(),s.Nb(11,"div",2),s.kc(12,m,6,3,"ng-container",3),s.Mb(),s.Mb(),s.Nb(13,"ion-list"),s.Nb(14,"ion-list-header"),s.Nb(15,"ion-label"),s.lc(16,"\u67e5\u8a62\u65b9\u5f0f"),s.Mb(),s.Mb(),s.Nb(17,"ion-radio-group",4),s.Vb("ngModelChange",(function(t){return s.gc(n),s.Xb().type=t})),s.Nb(18,"ion-item"),s.Jb(19,"ion-radio",5),s.Nb(20,"ion-label"),s.lc(21,"AND"),s.Mb(),s.Mb(),s.Nb(22,"ion-item"),s.Jb(23,"ion-radio",6),s.Nb(24,"ion-label"),s.lc(25,"OR"),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Nb(26,"div",7),s.kc(27,y,2,0,"ion-button",8),s.Mb(),s.Mb(),s.Kb()}if(2&n){const n=s.Xb();s.yb(12),s.cc("ngForOf",n.tags),s.yb(5),s.cc("ngModel",n.type),s.yb(10),s.cc("ngIf",n.topics.length>0)}}function k(n,t){if(1&n&&(s.Nb(0,"ion-chip"),s.Nb(1,"ion-label"),s.lc(2),s.Mb(),s.Mb()),2&n){const n=t.$implicit;s.yb(2),s.mc(n)}}function S(n,t){if(1&n&&(s.Nb(0,"ion-col",14),s.Nb(1,"div",18),s.Nb(2,"div"),s.Nb(3,"a",19),s.lc(4),s.Mb(),s.Mb(),s.Nb(5,"div"),s.Nb(6,"small"),s.lc(7),s.Mb(),s.Mb(),s.Mb(),s.Mb()),2&n){const n=s.Xb(2);s.yb(3),s.dc("href",n.questionSet.url,s.ic),s.yb(1),s.mc(n.questionSet.source),s.yb(3),s.mc(n.questionSet.url)}}function v(n,t){if(1&n&&(s.Nb(0,"ion-col",14),s.lc(1),s.Mb()),2&n){const n=s.Xb(2);s.yb(1),s.nc(" ",n.questionSet.content," ")}}function w(n,t){if(1&n&&s.Jb(0,"ion-icon",24),2&n){const n=s.Xb().$implicit;s.dc("name",n.isAnswer?"checkmark":"close")}}function C(n,t){if(1&n&&(s.Nb(0,"ion-item"),s.Jb(1,"ion-radio",22),s.Nb(2,"ion-label"),s.lc(3),s.Mb(),s.kc(4,w,1,1,"ion-icon",23),s.Mb()),2&n){const n=t.$implicit,i=s.Xb().index,o=s.Xb(2);s.yb(1),s.dc("value",n.content),s.yb(2),s.mc(n.content),s.yb(1),s.cc("ngIf",o.isShowAnswer[i])}}function O(n,t){if(1&n&&s.Jb(0,"ion-item",20),2&n){const n=s.Xb().$implicit;s.cc("innerHtml",n.comment,s.hc)}}function A(n,t){if(1&n){const n=s.Ob();s.Nb(0,"ion-col",14),s.Nb(1,"ion-list"),s.Jb(2,"ion-item",20),s.Nb(3,"ion-radio-group"),s.kc(4,C,5,3,"ion-item",3),s.Mb(),s.kc(5,O,1,1,"ion-item",21),s.Nb(6,"ion-item"),s.Nb(7,"ion-label"),s.lc(8,"\u986f\u793a\u7b54\u6848"),s.Mb(),s.Nb(9,"ion-toggle",4),s.Vb("ngModelChange",(function(i){s.gc(n);const o=t.index;return s.Xb(2).isShowAnswer[o]=i})),s.Mb(),s.Mb(),s.Mb(),s.Mb()}if(2&n){const n=t.$implicit,i=t.index,o=s.Xb(2);s.yb(2),s.cc("innerHtml",n.content,s.hc),s.yb(2),s.cc("ngForOf",n.options),s.yb(1),s.cc("ngIf",o.isShowAnswer[i]),s.yb(4),s.cc("ngModel",o.isShowAnswer[i])}}function I(n,t){if(1&n){const n=s.Ob();s.Nb(0,"ion-button",9),s.Vb("click",(function(){return s.gc(n),s.Xb(2).onBtnQueryPreviousClicked()})),s.lc(1,"\u4e0a\u4e00\u984c"),s.Mb()}}function q(n,t){if(1&n){const n=s.Ob();s.Nb(0,"ion-button",9),s.Vb("click",(function(){return s.gc(n),s.Xb(2).onBtnQueryNextClicked()})),s.lc(1,"\u4e0b\u4e00\u984c"),s.Mb()}}function X(n,t){if(1&n){const n=s.Ob();s.Lb(0),s.Nb(1,"ion-item",12),s.Nb(2,"ion-label"),s.lc(3,"\u8a18\u4f4f\u9032\u5ea6"),s.Mb(),s.Nb(4,"ion-toggle",13),s.Vb("ngModelChange",(function(t){return s.gc(n),s.Xb().isAutoSave=t}))("ionChange",(function(t){return s.gc(n),s.Xb().onAutoSaveChange(t)})),s.Mb(),s.Mb(),s.Nb(5,"ion-grid"),s.Nb(6,"ion-row"),s.Nb(7,"ion-col",14),s.kc(8,k,3,1,"ion-chip",3),s.Mb(),s.kc(9,S,8,3,"ion-col",15),s.kc(10,v,2,1,"ion-col",15),s.kc(11,A,10,4,"ion-col",16),s.Mb(),s.Mb(),s.Nb(12,"ion-grid"),s.Nb(13,"ion-row"),s.Nb(14,"ion-col",17),s.Nb(15,"div"),s.kc(16,I,2,0,"ion-button",8),s.kc(17,q,2,0,"ion-button",8),s.Mb(),s.Nb(18,"p",17),s.Nb(19,"small"),s.lc(20),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Mb(),s.Kb()}if(2&n){const n=s.Xb();s.yb(4),s.cc("ngModel",n.isAutoSave),s.yb(4),s.cc("ngForOf",n.topics),s.yb(1),s.cc("ngIf",n.questionSet.source||n.questionSet.url),s.yb(1),s.cc("ngIf",n.questionSet.content),s.yb(1),s.cc("ngForOf",null==n.questionSet?null:n.questionSet.questions),s.yb(5),s.cc("ngIf",n.current>1),s.yb(1),s.cc("ngIf",n.current<n.total),s.yb(3),s.oc("",n.current," / ",n.total,"")}}const x=[{path:"",component:(()=>{class n{constructor(n,t,i){var o;this.tagService=n,this.questionService=t,this.toastController=i,this.isAutoSave=!1,this.response=null,this.tags=[],this.topics=[],this.type="AND",this.questionSet=null,this.total=0,this.current=1,this.isShowAnswer=[],this.isAutoSave="TRUE"===(null===(o=localStorage.getItem("isAutoSaveFilter"))||void 0===o?void 0:o.toUpperCase()),this.response=localStorage.getItem("lastAutiSaveFilterDoc"),this.tagService.list().subscribe(n=>{this.tags=n.map(n=>{const t=n.payload.doc.data();return Object.assign({id:n.payload.doc.id},t)})})}ngOnInit(){}onAutoSaveChange(n){localStorage.setItem("isAutoSaveFilter",n.detail.checked)}onBtnAddTopicClicked(n){const t=this.topics.indexOf(n);-1===t?this.topics.push(n):this.topics.splice(t,1)}onBtnQueryClicked(){this.questionService.countWithTopic({topics:this.topics,type:this.type}).subscribe(n=>{this.total=n}),this.queryWithTopic(0)}onBtnQueryNextClicked(){this.queryWithTopic(1)}onBtnQueryPreviousClicked(){this.queryWithTopic(-1)}onBtnShowAnswerClicked(n){this.isShowAnswer[n]=!this.isShowAnswer[n]}queryWithTopic(n){this.current+=n,this.questionService.listWithTopic({direction:n,type:this.type,topics:this.topics,response:this.response}).subscribe(n=>{var t,i;this.response=null===(t=n[0])||void 0===t?void 0:t.payload.doc,localStorage.setItem("lastAutiSaveFilterDoc",this.isAutoSave?this.response:null),this.questionSet=n.map(n=>{const t=n.payload.doc.data();return Object.assign({id:n.payload.doc.id},t)})[0],this.isShowAnswer=[],null===(i=this.questionSet)||void 0===i||i.questions.forEach(n=>{this.isShowAnswer.push(!1)}),this.questionSet||this.toastController.create({message:"\u67e5\u7121\u8cc7\u6599",duration:3e3,color:"danger"}).then(n=>{n.present()})})}}return n.\u0275fac=function(t){return new(t||n)(s.Ib(r),s.Ib(u.a),s.Ib(e.K))},n.\u0275cmp=s.Cb({type:n,selectors:[["app-filter"]],decls:3,vars:2,consts:[[4,"ngIf"],[1,"pnl-title"],[1,"pnl-topics"],[4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],["slot","start","value","AND"],["slot","start","value","OR"],[1,"pnl-query","ion-text-center"],[3,"click",4,"ngIf"],[3,"click"],["name","checkmark",4,"ngIf"],["name","checkmark"],["lines","full"],[3,"ngModel","ngModelChange","ionChange"],["size","12"],["size","12",4,"ngIf"],["size","12",4,"ngFor","ngForOf"],[1,"ion-text-center"],[1,"pnl-source"],["target","_blank",3,"href"],[3,"innerHtml"],[3,"innerHtml",4,"ngIf"],["slot","start",3,"value"],["slot","end",3,"name",4,"ngIf"],["slot","end",3,"name"]],template:function(n,t){1&n&&(s.Nb(0,"ion-content"),s.kc(1,N,28,3,"ng-container",0),s.kc(2,X,21,9,"ng-container",0),s.Mb()),2&n&&(s.yb(1),s.cc("ngIf",!t.questionSet),s.yb(1),s.cc("ngIf",t.questionSet))},directives:[e.h,o.i,e.n,e.o,e.m,o.h,e.s,e.J,c.d,c.e,e.l,e.r,e.H,e.f,e.k,e.c,e.D,e.a,e.i,e.u,e.g],styles:[".pnl-title[_ngcontent-%COMP%]{margin-top:2rem}.pnl-source[_ngcontent-%COMP%], .pnl-title[_ngcontent-%COMP%], .pnl-topics[_ngcontent-%COMP%]{margin-left:1rem}.pnl-query[_ngcontent-%COMP%], .pnl-source[_ngcontent-%COMP%]{margin-top:1rem}"]}),n})()}];let F=(()=>{class n{}return n.\u0275mod=s.Gb({type:n}),n.\u0275inj=s.Fb({factory:function(t){return new(t||n)},imports:[[b.h.forChild(x)],b.h]}),n})(),T=(()=>{class n{}return n.\u0275mod=s.Gb({type:n}),n.\u0275inj=s.Fb({factory:function(t){return new(t||n)},imports:[[o.b,c.a,e.F,F]]}),n})()}}]);